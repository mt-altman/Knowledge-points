<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElasticSearch基础概念</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Inter:wght@400;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body { font-family: 'Noto Sans SC', 'Inter', sans-serif; }
        code { font-family: 'Fira Code', monospace; }
        .gradient-header { background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%); }
        .code-block { background-color: #f8f9fa; border-left: 4px solid #4b6cb7; }
        @media print {
            .no-print { display: none; }
            .page-break { page-break-after: always; }
            body { font-size: 12pt; }
        }
    /* 返回首页按钮样式 */
        .home-button-fixed {
            position: fixed;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background-color 0.3s, transform 0.2s;
        }
        .home-button-fixed:hover {
            background-color: #2980b9;
            transform: translateY(-50%) translateX(2px);
        }
        .home-button-fixed svg {
            width: 20px;
            height: 20px;
        }
        @media (max-width: 768px) {
            .home-button-fixed {
                top: 50%;
                left: 10px;
                width: 36px;
                height: 36px;
            }
            .home-button-fixed svg {
                width: 18px;
                height: 18px;
            }
        }</style>
</head>
<body class="bg-gray-50"><a href="../index.html" class="home-button-fixed" title="返回首页"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg></a>
    <header class="gradient-header text-white py-8 px-4 md:px-8 shadow-lg">
        <div class="container mx-auto">
            <h1 class="text-2xl md:text-4xl font-bold mb-2">ElasticSearch基础概念</h1>
            <div class="bg-blue-800 bg-opacity-50 inline-block px-3 py-1 rounded-full text-sm">
                <span class="font-bold">复杂度评估：</span><span class="ml-1">中级</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 md:px-8 py-6">
        <!-- 1. 术语定义 -->
        <section class="mb-10 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl md:text-2xl font-bold mb-4 border-b pb-2">术语定义</h2>
            <div class="space-y-4">
                <p>ElasticSearch (ES) 是一个基于 Lucene 的分布式、RESTful 风格的搜索和分析引擎，专为水平扩展、高可靠性和易管理而设计。它能够快速存储、搜索和分析大量数据，并以近实时的方式返回结果。</p>
                
                <div class="flex flex-col md:flex-row gap-4 mt-4">
                    <div class="flex-1 bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-bold text-blue-700 mb-2">核心特性</h3>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>分布式架构，支持PB级数据</li>
                            <li>近实时搜索和分析</li>
                            <li>多租户能力</li>
                            <li>全文检索与结构化查询</li>
                            <li>RESTful API</li>
                        </ul>
                    </div>
                    <div class="flex-1 bg-green-50 p-4 rounded-lg">
                        <h3 class="font-bold text-green-700 mb-2">主要用途</h3>
                        <ul class="list-disc pl-5 space-y-1">
                            <li>企业搜索</li>
                            <li>日志分析</li>
                            <li>应用性能监控</li>
                            <li>安全分析</li>
                            <li>业务分析</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. 实现细节与优化 -->
        <section class="mb-10 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl md:text-2xl font-bold mb-4 border-b pb-2">实现细节与优化</h2>
            
            <h3 class="font-bold text-lg mb-3">核心概念</h3>
            <div class="overflow-x-auto mb-6">
                <table class="min-w-full bg-white border border-gray-200">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="py-2 px-4 border">ES概念</th>
                            <th class="py-2 px-4 border">对应关系型数据库</th>
                            <th class="py-2 px-4 border">说明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 border font-medium">索引 (Index)</td>
                            <td class="py-2 px-4 border">数据库</td>
                            <td class="py-2 px-4 border">存储相关文档的地方</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border font-medium">类型 (Type)</td>
                            <td class="py-2 px-4 border">表</td>
                            <td class="py-2 px-4 border">7.0后已弃用</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border font-medium">文档 (Document)</td>
                            <td class="py-2 px-4 border">行</td>
                            <td class="py-2 px-4 border">JSON格式的数据</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border font-medium">字段 (Field)</td>
                            <td class="py-2 px-4 border">列</td>
                            <td class="py-2 px-4 border">文档中的数据字段</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border font-medium">映射 (Mapping)</td>
                            <td class="py-2 px-4 border">表结构</td>
                            <td class="py-2 px-4 border">定义文档字段类型</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3 class="font-bold text-lg mb-3">分布式架构</h3>
            <div class="mb-6">
                <div class="mermaid p-4 rounded-lg">
                graph TD
                    A[客户端/Client] --> B[协调节点/Coordinator Node]
                    B --> C[数据节点1/Data Node 1]
                    B --> D[数据节点2/Data Node 2]
                    B --> E[数据节点3/Data Node 3]
                    C --> F[主分片/Primary Shard]
                    D --> G[主分片/Primary Shard]
                    E --> H[主分片/Primary Shard]
                    C --> I[副本分片/Replica Shard]
                    D --> J[副本分片/Replica Shard]
                    E --> K[副本分片/Replica Shard]

                </div>
            </div>

            <h3 class="font-bold text-lg mb-3">索引操作示例</h3>
            <div class="code-block p-4 rounded-lg mb-6">
                <code class="text-sm">
// 创建索引<br>
PUT /my_index<br>
{<br>
  "settings": {<br>
    "number_of_shards": 3,   // 主分片数<br>
    "number_of_replicas": 1  // 每个主分片的副本数<br>
  },<br>
  "mappings": {<br>
    "properties": {<br>
      "title": { "type": "text" },<br>
      "content": { "type": "text" },<br>
      "date": { "type": "date" }<br>
    }<br>
  }<br>
}
                </code>
            </div>
        </section>

        <!-- 3. 应用场景 -->
        <section class="mb-10 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl md:text-2xl font-bold mb-4 border-b pb-2">应用场景</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-bold text-lg mb-2">全文搜索</h3>
                    <p>电商网站商品搜索、内容网站文章搜索等，支持模糊匹配、拼写纠错、同义词扩展。</p>
                    <div class="code-block p-3 rounded-lg mt-2 text-sm">
                        <code>
GET /products/_search<br>
{<br>
  "query": {<br>
    "multi_match": {<br>
      "query": "智能手机",<br>
      "fields": ["title", "description"]<br>
    }<br>
  }<br>
}
                        </code>
                    </div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-bold text-lg mb-2">日志分析</h3>
                    <p>收集、存储和分析应用程序日志，实现错误监控、性能分析和安全审计。</p>
                    <div class="code-block p-3 rounded-lg mt-2 text-sm">
                        <code>
GET /logs-*/_search<br>
{<br>
  "query": {<br>
    "bool": {<br>
      "must": [<br>
        { "match": { "level": "ERROR" } },<br>
        { "range": { "@timestamp": { "gte": "now-1d" } } }<br>
      ]<br>
    }<br>
  }<br>
}
                        </code>
                    </div>
                </div>
            </div>

            <div class="bg-blue-50 p-4 rounded-lg">
                <h3 class="font-bold text-lg mb-2">实际应用案例</h3>
                <ul class="list-disc pl-5 space-y-2">
                    <li><strong>GitHub</strong>：使用ES搜索超过1300万代码仓库</li>
                    <li><strong>维基百科</strong>：为全文搜索和实时数据分析提供支持</li>
                    <li><strong>Stack Overflow</strong>：为问答平台提供搜索功能</li>
                    <li><strong>Netflix</strong>：用于日志分析和内容推荐系统</li>
                </ul>
            </div>
        </section>

        <!-- 4. 比较分析 -->
        <section class="mb-10 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl md:text-2xl font-bold mb-4 border-b pb-2">比较分析</h2>
            
            <div class="overflow-x-auto mb-6">
                <table class="min-w-full bg-white border border-gray-200">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="py-2 px-4 border">特性</th>
                            <th class="py-2 px-4 border">ElasticSearch</th>
                            <th class="py-2 px-4 border">Solr</th>
                            <th class="py-2 px-4 border">传统关系型数据库</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 border">全文搜索</td>
                            <td class="py-2 px-4 border text-green-600">强大</td>
                            <td class="py-2 px-4 border text-green-600">强大</td>
                            <td class="py-2 px-4 border text-red-600">有限</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border">分布式扩展</td>
                            <td class="py-2 px-4 border text-green-600">原生支持</td>
                            <td class="py-2 px-4 border text-yellow-600">需配置</td>
                            <td class="py-2 px-4 border text-red-600">复杂</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border">实时性</td>
                            <td class="py-2 px-4 border text-green-600">近实时</td>
                            <td class="py-2 px-4 border text-yellow-600">批处理</td>
                            <td class="py-2 px-4 border text-green-600">实时</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border">数据一致性</td>
                            <td class="py-2 px-4 border text-yellow-600">最终一致性</td>
                            <td class="py-2 px-4 border text-yellow-600">最终一致性</td>
                            <td class="py-2 px-4 border text-green-600">强一致性</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border">查询语言</td>
                            <td class="py-2 px-4 border">JSON DSL</td>
                            <td class="py-2 px-4 border">XML/JSON</td>
                            <td class="py-2 px-4 border">SQL</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="bg-yellow-50 p-4 rounded-lg">
                <h3 class="font-bold text-lg mb-2">适用场景选择</h3>
                <ul class="list-disc pl-5 space-y-1">
                    <li><strong>选择 ElasticSearch</strong>：需要复杂搜索功能、大规模数据分析、日志处理</li>
                    <li><strong>选择关系型数据库</strong>：需要强事务支持、复杂关联查询、严格数据一致性</li>
                    <li><strong>混合使用</strong>：关系型数据库存储核心业务数据，ES处理搜索和分析需求</li>
                </ul>
            </div>
        </section>

        <!-- 5. 总结 -->
        <section class="mb-10 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl md:text-2xl font-bold mb-4 border-b pb-2">总结</h2>
            
            <div class="mb-6">
                <div class="mermaid code-block p-4 rounded-lg">
mindmap
  root((ElasticSearch))
    核心概念
      索引
      文档
      分片
      映射
    特性
      分布式
      可扩展
      近实时
      RESTful API
    应用场景
      全文搜索
      日志分析
      指标分析
      安全分析
    生态系统
      Kibana
      Logstash
      Beats
                </div>
            </div>

            <div class="bg-green-50 p-4 rounded-lg mb-6">
                <h3 class="font-bold text-lg mb-2">最佳实践</h3>
                <ul class="list-disc pl-5 space-y-1">
                    <li>合理设计索引和映射，避免过度使用嵌套文档</li>
                    <li>根据数据量和查询模式优化分片数量</li>
                    <li>使用别名管理索引，便于重建和迁移</li>
                    <li>定期监控集群健康状态和性能指标</li>
                    <li>实施数据生命周期管理，定期归档冷数据</li>
                </ul>
            </div>

            <div class="bg-red-50 p-4 rounded-lg">
                <h3 class="font-bold text-lg mb-2">常见问题</h3>
                <div class="space-y-3">
                    <div>
                        <p class="font-medium">问题：集群状态变为黄色或红色</p>
                        <p class="text-sm">解决：检查节点连接、分片分配和磁盘空间</p>
                    </div>
                    <div>
                        <p class="font-medium">问题：搜索性能下降</p>
                        <p class="text-sm">解决：优化查询、检查索引设计、增加缓存</p>
                    </div>
                    <div>
                        <p class="font-medium">问题：内存使用过高</p>
                        <p class="text-sm">解决：调整JVM堆大小、优化字段映射、控制分片大小</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 6. 参考资料 -->
        <section class="mb-10 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl md:text-2xl font-bold mb-4 border-b pb-2">参考资料</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-bold text-lg mb-2">官方文档</h3>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><a href="https://www.elastic.co/guide/index.html" class="text-blue-600 hover:underline">Elastic官方文档</a></li>
                        <li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html" class="text-blue-600 hover:underline">Elasticsearch权威指南（中文版）</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="font-bold text-lg mb-2">推荐书籍</h3>
                    <ul class="list-disc pl-5 space-y-1">
                        <li>《Elasticsearch实战》 - Radu Gheorghe等著</li>
                        <li>《深入理解Elasticsearch》 - 张超等著</li>
                        <li>《Elasticsearch 7.0实战》 - 张超等著</li>
                    </ul>
                </div>
            </div>

            <div class="mt-6">
                <h3 class="font-bold text-lg mb-2">进阶学习资源</h3>
                <ul class="list-disc pl-5 space-y-1">
                    <li><a href="https://www.elastic.co/cn/webinars" class="text-blue-600 hover:underline">Elastic官方网络研讨会</a></li>
                    <li><a href="https://www.elastic.co/cn/blog" class="text-blue-600 hover:underline">Elastic官方博客</a></li>
                    <li><a href="https://github.com/elastic/elasticsearch" class="text-blue-600 hover:underline">Elasticsearch GitHub仓库</a></li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white py-6 px-4 md:px-8">
        <div class="container mx-auto text-center">
            <p>© 2023 ElasticSearch基础概念学习指南</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化Mermaid图表
            mermaid.initialize({
                startOnLoad: true,
                theme: 'neutral', 
                securityLevel: 'loose',
                flowchart: { curve: 'basis' }
            });
            
            // 代码块复制功能
            document.querySelectorAll('.code-block').forEach(block => {
                const copyBtn = document.createElement('button');
                copyBtn.className = 'absolute top-2 right-2 bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs';
                copyBtn.textContent = '复制';
                copyBtn.onclick = function() {
                    const code = block.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        copyBtn.textContent = '已复制!';
                        setTimeout(() => {
                            copyBtn.textContent = '复制';
                        }, 2000);
                    });
                };
                
                // 设置相对定位以便放置复制按钮
                block.style.position = 'relative';
                block.appendChild(copyBtn);
            });
        });
    </script>
</body>
</html>
